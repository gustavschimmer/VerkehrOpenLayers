<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenLayers Basemap</title>
    <link rel="stylesheet" href="styles.css" type="text/css">
    <script src="v9.0.0-package\dist\ol.js"></script>

    
</head>
<body>
    <div>
        <!-- Dropdown-Menü zur Auswahl des Polygons -->
        <select id="polygonSelector" onchange="changePolygon()">
            <!-- Optionen werden später dynamisch hinzugefügt -->
        </select>
    </div>
    <div id="map"></div>
    <script>
        // Erstellen einer OpenLayers Karte
        var map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM() // OpenStreetMap als Hintergrundkarte
                })
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([0, 0]), // Zentrierung der Karte auf Nullpunkt
                zoom: 2 // Standard-Zoomstufe
            })
        });

        // Vector Layer erstellen
        var vectorLayer = new ol.layer.Vector({
            source: new ol.source.Vector(),
            name: 'vectorLayer' // Name des Vector-Layers setzen
        });
        map.addLayer(vectorLayer);

        // Funktion zum Ändern des angezeigten Polygons
        function changePolygon() {
            var selectedPolygonIndex = document.getElementById("polygonSelector").value;
            var features = vectorLayer.getSource().getFeatures();
            vectorLayer.getSource().clear(); // Alle Features entfernen

            if (selectedPolygonIndex != "all") {
                vectorLayer.getSource().addFeature(features[selectedPolygonIndex]);
            } else {
                vectorLayer.getSource().addFeatures(features);
            }

            // Karte auf die Bounding Box des ausgewählten Polygons (oder aller Polygone) zentrieren und zoomen
            var extent = vectorLayer.getSource().getExtent();
            map.getView().fit(extent, { padding: [50, 50, 50, 50] });
        }

        // Einbinden der GeoJSON-Datei und Erstellen des Dropdown-Menüs
        fetch('masterBoundary.geojson')
            .then(response => response.json())
            .then(data => {
                var features = new ol.format.GeoJSON().readFeatures(data, {
                    featureProjection: 'EPSG:3857'
                });

                // Features zum Vector-Layer hinzufügen
                vectorLayer.getSource().addFeatures(features);

                // Dropdown-Menü erstellen und Optionen hinzufügen
                var dropdown = document.getElementById("polygonSelector");
                var option = document.createElement("option");
                option.text = "Alle Polygone anzeigen";
                option.value = "all";
                dropdown.add(option);

                for (var i = 0; i < features.length; i++) {
                    var option = document.createElement("option");
                    option.text = "Polygon " + (i + 1);
                    option.value = i.toString();
                    dropdown.add(option);
                }
            });
    </script>
</body>
</html>